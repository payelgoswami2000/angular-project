(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[88],{Glit:function(t,e,n){"use strict";n.d(e,"b",(function(){return c}));var r=n("QkVN"),o=n.n(r);function a(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c={description:"",descriptionError:null,isTaggable:!0,link:"",linkError:null,media:null,pinTagIds:[],selectedPinTagId:null,tagError:null,title:"",titleError:null,canvasJson:null,signals:{},userMentionTags:[]};e.a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"PIN_DRAFT_ADD_PIN_ITEM":case"PIN_ITEM_UPDATE_DATA":var n=e.payload.pinItem||{};return l(l(l({},t),n),{},{signals:l(l({},t.signals),n.signals)});case"PIN_ITEM_ADD_PIN_TAG":var r=e.payload.pinTagId;return l(l({},t),{},{pinTagIds:[].concat(a(t.pinTagIds),[r])});case"PIN_ITEM_REMOVE_PIN_TAG":var i=e.payload.pinTagId;return l(l({},t),{},{pinTagIds:t.pinTagIds.filter((function(t){return t!==i}))});case"PIN_ITEM_SET_DESCRIPTION":var u=e.payload.description;return l(l({},t),{},{description:u});case"PIN_ITEM_SET_DESCRIPTION_ERROR":var s=e.payload,d=s.descriptionError,f=s.signals;return l(l({},t),{},{descriptionError:d,signals:l(l({},t.signals),f)});case"PIN_ITEM_SET_IS_TAGGABLE":var p=e.payload.isTaggable;return l(l({},t),{},{isTaggable:p});case"PIN_ITEM_SET_LINK":var m=e.payload.link;return l(l({},t),{},{link:m});case"PIN_ITEM_SET_LINK_ERROR":var g=e.payload,h=g.linkError,y=g.signals;return l(l({},t),{},{linkError:h,signals:l(l({},t.signals),y)});case"PIN_ITEM_SET_MEDIA":var v=e.payload.media,S=!(!v||t.link)||t.isTaggable;return l(l({},t),{},{media:v,isTaggable:(!v||"localVideo"!==v.type)&&S,pinTagIds:[],selectedPinTagId:null,canvasJson:null});case"PIN_ITEM_UPDATE_MEDIA":var b=e.payload.media;return l(l({},t),{},{media:t.media?o()({},t.media,b):null});case"PIN_ITEM_SET_SELECTED_PIN_TAG_ID":var I=e.payload.selectedPinTagId;return l(l({},t),{},{selectedPinTagId:I});case"PIN_ITEM_SET_TAG_ERROR":var O=e.payload.tagError;return l(l({},t),{},{tagError:O});case"PIN_ITEM_SET_TITLE":var w=e.payload.title;return l(l({},t),{},{title:w});case"PIN_ITEM_SET_TITLE_ERROR":var T=e.payload,F=T.titleError,P=T.signals;return l(l({},t),{},{titleError:F,signals:l(l({},t.signals),P)});case"PIN_ITEM_SET_EDITED_IMAGE":var U=e.payload,E=U.editedMedia,M=U.canvasJson;return l(l({},t),{},{media:E,canvasJson:M});default:return t}}},IIK6:function(t,e,n){"use strict";n.d(e,"W",(function(){return r})),n.d(e,"O",(function(){return o})),n.d(e,"N",(function(){return a})),n.d(e,"J",(function(){return i})),n.d(e,"K",(function(){return u})),n.d(e,"L",(function(){return l})),n.d(e,"S",(function(){return s})),n.d(e,"R",(function(){return c})),n.d(e,"P",(function(){return d})),n.d(e,"Q",(function(){return f})),n.d(e,"U",(function(){return p})),n.d(e,"T",(function(){return m})),n.d(e,"V",(function(){return g})),n.d(e,"y",(function(){return h})),n.d(e,"X",(function(){return y})),n.d(e,"u",(function(){return v})),n.d(e,"x",(function(){return S})),n.d(e,"B",(function(){return b})),n.d(e,"v",(function(){return I})),n.d(e,"w",(function(){return O})),n.d(e,"A",(function(){return w})),n.d(e,"t",(function(){return T})),n.d(e,"e",(function(){return F})),n.d(e,"f",(function(){return P})),n.d(e,"fb",(function(){return U})),n.d(e,"b",(function(){return E})),n.d(e,"gb",(function(){return M})),n.d(e,"c",(function(){return A})),n.d(e,"d",(function(){return _})),n.d(e,"hb",(function(){return k})),n.d(e,"a",(function(){return C})),n.d(e,"r",(function(){return D})),n.d(e,"cb",(function(){return R})),n.d(e,"db",(function(){return j})),n.d(e,"eb",(function(){return x})),n.d(e,"s",(function(){return N})),n.d(e,"C",(function(){return H})),n.d(e,"Y",(function(){return G})),n.d(e,"Z",(function(){return W})),n.d(e,"I",(function(){return L})),n.d(e,"ib",(function(){return z})),n.d(e,"q",(function(){return B})),n.d(e,"g",(function(){return V})),n.d(e,"j",(function(){return q})),n.d(e,"i",(function(){return J})),n.d(e,"k",(function(){return K})),n.d(e,"l",(function(){return X})),n.d(e,"m",(function(){return Z})),n.d(e,"n",(function(){return $})),n.d(e,"p",(function(){return Q})),n.d(e,"o",(function(){return Y})),n.d(e,"kb",(function(){return tt})),n.d(e,"jb",(function(){return et})),n.d(e,"nb",(function(){return nt})),n.d(e,"pb",(function(){return rt})),n.d(e,"qb",(function(){return ot})),n.d(e,"rb",(function(){return at})),n.d(e,"mb",(function(){return it})),n.d(e,"ob",(function(){return ut})),n.d(e,"lb",(function(){return lt})),n.d(e,"bb",(function(){return st})),n.d(e,"M",(function(){return ct})),n.d(e,"h",(function(){return dt})),n.d(e,"z",(function(){return ft})),n.d(e,"ab",(function(){return pt})),n.d(e,"D",(function(){return mt})),n.d(e,"E",(function(){return gt})),n.d(e,"F",(function(){return ht})),n.d(e,"H",(function(){return yt})),n.d(e,"G",(function(){return vt}));var r=880,o=340,a=510,i=40,u=20,l=4,s=474,c=186,d=40,f=10,p=88,m=183,g=130,h=24,y=400,v=50,S=8,b=8,I=5,O=20,w=13,T=5,F=20,P=Math.pow(F,2),U=100,E=500,M=40,A=100,_=5,k=["attempted","publishing","succeeded","uploading"],C={carousel:[{w:2,h:3},{w:3,h:4},{w:1,h:1}],single:[{w:2,h:3},{w:3,h:4},{w:1,h:1}],story:[{w:9,h:16}]},D=["tl","tc","tr","bl","bc","br"],R=["left","center"],j=["top","center","bottom"],x=["none","uppercase"],N=["sm","md","lg"],H=[1,.75],G=198,W=132,L=(Math.floor(16*W/9),1),z=56,B=240,V="cubic-bezier(0.66, 0.025, 0.33, 0.975)",q=["image/bmp","image/gif","image/jpeg","image/png","image/tiff","image/webp"],J=["bmp","gif","jpg","jpeg","png","tiff","webp"],K=89478485,X=20971520,Z=100,$=100,Q=1e3,Y=1500,tt=["video/mp4","video/x-m4v","video/quicktime"],et=["mp4","m4v","mov"],nt=2147483648,rt=4,ot=Z,at=$,it=900,ut=.5,lt=1.91,st=2,ct=["processing","publishing","saving"],dt=2500,ft=3,pt=5e3,mt="pin-builder-default-education-id",gt="pin-builder-default-tour-id",ht="pin-builder-editing-tour-id",yt="pin-builder-partner-modal-education-id",vt="pin-builder-partner-first-tour-id"},ZQVr:function(t,e,n){"use strict";n.d(e,"a",(function(){return y})),n.d(e,"c",(function(){return v})),n.d(e,"d",(function(){return S})),n.d(e,"b",(function(){return b})),n.d(e,"j",(function(){return O})),n.d(e,"g",(function(){return T})),n.d(e,"h",(function(){return F})),n.d(e,"f",(function(){return P})),n.d(e,"e",(function(){return U})),n.d(e,"i",(function(){return E}));var r=n("1ycI"),o=n("eOdZ"),a=n("zwad");function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=t[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(l){o=!0,a=l}finally{try{r||null==u.return||u.return()}finally{if(o)throw a}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var d=1e3,f=[200,201,204],p=2e3,m=8e3,g=6e4,h=3e5;function y(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:512,n=t.split(";"),r=n[0].split(":")[1],o=n[1].split(",")[1],a=atob(o),i=[],u=0;u<a.length;u+=e){for(var l=a.slice(u,u+e),s=new Array(l.length),c=0;c<l.length;c+=1)s[c]=l.charCodeAt(c);var d=new Uint8Array(s);i.push(d)}return new Blob(i,{type:r})}function v(t){return new Promise((function(e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="blob",n.onload=function(t){if(200===n.status){var r=n.response,o=new FileReader;o.onloadend=function(){var t="string"==typeof o.result?o.result:"";e(t)},o.readAsDataURL(r)}},n.send()}))}function S(){return o.a.create("VisualLinkBoardResource").callCreate().then((function(t){return t.resource_response.data}))}function b(t){return o.a.create("PinResource",t).callCreate().then((function(t){return t.resource_response.data}))}function I(t,e){var n,r,a=e.onSuccess,i=e.onError,u=e.onProcessingStarted,l=e.resolvedAfterProcessingStarted,s=e.delay,c=void 0===s?p:s,d=!1,f=function(){clearTimeout(r),clearTimeout(n)};!function e(){d||o.a.create("VIPResource",{upload_ids:[t]}).callGet().then((function(o){var s=o.resource_response.data;if(s[t]){var p=s[t],m=p.status,y=p.signature,v=p.failure_code;n||(n=setTimeout((function(){d=!0,i("","registered_timeout")}),g)),r||(r=setTimeout((function(){d=!0,i("","processing_timeout")}),h)),"processing"===m||"registered"===m?"processing"===m?(clearTimeout(n),u?l?(clearTimeout(r),u(y)):(u(y),setTimeout((function(){return e()}),c)):setTimeout((function(){return e()}),c)):setTimeout((function(){return e()}),c):"succeeded"===m?(f(),a(y)):(f(),i("VIP status failure code: ".concat(v),null))}else i("VIP upload ID was not returned",null)})).catch((function(){i("VIP failure with checking status",null)}))}()}function O(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;return new Promise((function(a,i){o.a.create("VIPResource",{type:e}).callCreate().then((function(o){var u=r||{},l=u.onCancelUpload,s=u.onFailureUpload,c=u.onFinishProcessing,g=u.onFinishUpload,h=u.onProgress,y=u.onStartProcessing,v=u.onStartUpload,S=u.setXhr,b=o.resource_response.data,O=b.upload_id,w=b.upload_url,T=b.upload_parameters,F=new Date;v&&v(O);var P=function(t,e){s&&s(O,t,e),i({isError:!0,uploadId:O})},U=new XMLHttpRequest;U.open("POST",w,!0),U.onabort=function(){l&&l(O),i({isError:!1,uploadId:O})},U.onload=function(){if(f.includes(U.status)){var t=new Date,r=(t-F)/d;if(g){var o=U.getResponseHeader("x-amz-request-id"),i=U.getResponseHeader("x-amz-id-2");g({amzId2:i,amzRequestId:o,statusCode:U.status,uploadId:O,uploadTime:r})}I(O,{onProcessingStarted:function(t){return y&&y(O,t),n?a({signature:t,uploadId:O}):void 0},delay:e.includes("image")?p:m,onError:P,onSuccess:function(e){var n=(new Date-t)/d;return c&&c(O,n,e,r),a({signature:e,uploadId:O})},resolvedAfterProcessingStarted:n})}else P("XHR failure status code: ".concat(U.status),null)},U.onerror=function(){U.abort()},h&&(U.upload.onprogress=h),S&&S(U);var E=new FormData;Object.keys(T).forEach((function(t){E.append(t,T[t])})),E.append("file",t),U.send(E)})).catch((function(t){i({isError:!0})}))}))}function w(t){return new Promise((function(e,n){var o=new FormData;o.append("img",t);var i=new XMLHttpRequest;i.open("POST",a.a.absolutify("/upload-image/"),!0),i.setRequestHeader("x-CSRFToken",r.default.getCSRFToken()),i.onload=function(){if(200===i.status){var t=JSON.parse(i.responseText);t.success?e(t):n(new Error(t.error))}else 413===i.status?n(new Error("Oops! Something went wrong while uploading your image. Try uploading a smaller image.")):n(new Error("Oops! Something went wrong while uploading your image (Status code ".concat(i.status,")")))},i.send(o)}))}function T(t){return"string"==typeof t?t.startsWith("data")?w(y(t)):v(t).then((function(t){return w(y(t))})):w(t)}function F(t){return T(t).then((function(t){return new Promise((function(e,n){var r=t.image_url;o.a.create("ScheduledPinResource",{image_url:r,method:"upload"}).callCreate().then((function(t){var n=t.resource_response.data.image_signature;e(n)})).catch((function(){n(new Error("Cannot schedule the Pin."))}))}))})).catch((function(t){throw t}))}function P(t){var e=t.filter((function(t){return!!t.media}));return Promise.all(e.map((function(t){return T(t.media&&t.media.src||"")}))).then((function(t){var e=t.map((function(t){return t.image_url}));return Promise.all([o.a.create("CarouselImageUploaderResource",{image_urls:e}).callUpdate(),e])})).then((function(t){var n=s(t,2),r=n[0],o=n[1],a=r.resource_response.data,i=e.findIndex((function(t,e){return!!a[e].image_signature})),l=(e.find((function(t){return!!t.description}))||{}).description,c=(e.find((function(t){return!!t.link}))||{}).link;return{metadata:{description:l||"",title:(e.find((function(t){return!!t.title}))||{}).title||"",link:c||"",imageSignature:a[i].image_signature||"",image_url:o[0]},slots:e.map((function(t,e){var n=a[e],r=t.description,o=t.title,i=t.link;return u(u({},n),{},{title:o,description:r,link:i})}))}})).catch((function(t){throw t}))}function U(t,e,n,r){return new Promise((function(a,i){o.a.create("VIPEditResource",u({type:e,video_signature:t},n)).callCreate().then((function(t){var e=r||{},n=e.onStartEdits,o=e.onFinishEdits,u=t.resource_response.data.tracking_id,l=new Date;n&&n(u),I(u,{delay:m,onError:function(t){return i(t)},onProcessingStarted:function(t){return a({signature:t,uploadId:u})},onSuccess:function(t){var e=(new Date-l)/d;o&&o(u,e,t),a({signature:t,uploadId:u})},resolvedAfterProcessingStarted:!0})})).catch((function(){i()}))}))}function E(t,e,n){return"string"==typeof t?t.startsWith("data")?O(y(t),e,!1,n):v(t).then((function(t){return O(y(t),e,!1,n)})):O(t,e,!1,n)}},ZVWG:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"d",(function(){return u})),n.d(e,"c",(function(){return l})),n.d(e,"b",(function(){return c}));var r=n("etmJ");function o(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return u=t.done,t},e:function(t){l=!0,i=t},f:function(){try{u||null==n.return||n.return()}finally{if(l)throw i}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var i=function(t,e){var n=/^\d{1,3}\.\d{1,3}(?:\.\d{1,6})?$/;if(!t.match(n)||!e.match(n))return null;for(var r=t.split("."),o=e.split("."),a=Math.max(r.length,o.length),i=0;i<a;i+=1){var u=i<r.length?parseInt(r[i],10):0,l=i<o.length?parseInt(o[i],10):0;if(u<l)return-1;if(u>l)return 1}return 0},u=function(t){return{defaultStyle:0,fontFamily:t.name,fontGroup:r.c,fontOverrides:{letterSpacing:t.letter_spacing,lineHeight:t.line_height},format:"truetype",id:t.id,styles:[{fontStyle:"",fontUrl:t.url,fontWeight:"normal",name:"normal"}]}};function l(t){var e,n=[],r="",a=o(t);try{for(a.s();!(e=a.n()).done;){var i=e.value;if(r){var u=!!i.match(/\s/),l=!!r.match(/\s/);if(u===l)r+=i;else if(!l&&r.includes("-")){for(var s=0,c=0;c<r.length;c+=1)"-"===r[c]&&(n.push(r.substring(s,c+1)),s=c+1);n.push(r.substring(s)),r=i}else n.push(r),r=i}else r=i}}catch(d){a.e(d)}finally{a.f()}return r.length&&n.push(r),n}function s(t){var e,n,r=t.font,a=t.fontSize,i=t.textList,u=t.width;if("undefined"==typeof document||!document.body||u<=0||a<=0)return[];var s=document.body,c=document.createElement("div");s.appendChild(c);var d=null!=(null===(e=r.fontOverrides)||void 0===e?void 0:e.letterSpacing)?"".concat(r.fontOverrides.letterSpacing,"px"):void 0,f=(null===(n=r.fontOverrides)||void 0===n?void 0:n.lineHeight)||1.1,p={letterSpacing:d,lineHeight:String(f),fontFamily:r.fontFamily,fontSize:"".concat(a,"px"),visibility:"hidden"};Object.assign(c.style,p);var m=document.createElement("div");m.style.display="inline",c.appendChild(m);var g=document.createTextNode("");m.appendChild(g);var h,y=[],v="",S=function(t){var e=t.trim();return g.textContent=e,{text:e,width:m.offsetWidth}},b=function t(e){var n=!!e.match(/\s/),r=0===v.length;if(g.textContent="".concat(v).concat(e),m.offsetWidth>u)if(n)y.push(S(v)),v="";else if(r){var a,i=o(e);try{for(i.s();!(a=i.n()).done;){t(a.value)}}catch(l){i.e(l)}finally{i.f()}}else y.push(S(v)),v="",t(e);else v+=e},I=o(i);try{for(I.s();!(h=I.n()).done;){var O=h.value;0===O.length&&y.push(S(v)),l(O).forEach((function(t){return b(t)})),v.length&&(y.push(S(v)),v="")}}catch(w){I.e(w)}finally{I.f()}return m.remove(),c.remove(),y}function c(t){var e,n,r=t.boxHeight,o=t.boxWidth,a=t.font,i=t.startFontSize,u=t.text;if("undefined"==typeof document||!document.body)return{fontSize:i,lines:[]};var l=document.body,c=document.createElement("div");l.appendChild(c);var d=u.split(/\r?\n/g),f=i,p=null!=(null===(e=a.fontOverrides)||void 0===e?void 0:e.letterSpacing)?"".concat(a.fontOverrides.letterSpacing,"px"):void 0,m=(null===(n=a.fontOverrides)||void 0===n?void 0:n.lineHeight)||1.1,g={letterSpacing:p,lineHeight:String(m),fontFamily:a.fontFamily,fontSize:"".concat(f,"px"),position:"absolute",visibility:"hidden",width:"".concat(o,"px")};Object.assign(c.style,g);var h=document.createElement("div");for(h.style.display="inline",c.appendChild(h),d.forEach((function(t,e){var n=document.createElement("span");n.style.wordBreak="break-word",h.appendChild(n),n.appendChild(document.createTextNode(t)),e!==u.length-1&&n.appendChild(document.createElement("br"))}));(h.offsetHeight>r||h.offsetWidth>o)&&f>0;)f-=1,c.style.fontSize="".concat(f,"px");return h.remove(),c.remove(),{fontSize:f,lines:f>0?s({font:a,fontSize:f,textList:d,width:o}):[]}}},etmJ:function(t,e,n){"use strict";n.d(e,"e",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return c})),n.d(e,"b",(function(){return d})),n.d(e,"a",(function(){return f})),n.d(e,"f",(function(){return p})),n.d(e,"j",(function(){return m})),n.d(e,"i",(function(){return g})),n.d(e,"h",(function(){return h})),n.d(e,"k",(function(){return y})),n.d(e,"m",(function(){return v})),n.d(e,"l",(function(){return S})),n.d(e,"g",(function(){return b}));var r=n("gIz7");function o(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var i="pin-builder-font-faces",u="system-font-faces",l="pin-builder-education-font-faces",s="licensed",c="system",d="brand",f=4,p=[{fontGroup:s,fontFamily:"A-FRAME",defaultStyle:0,format:"truetype",fontOverrides:{letterSpacing:0,lineHeight:.9,textTransform:!0},styles:[{name:"Black",fontStyle:"",fontWeight:"normal",fontUrl:"https://assets.pinterest.com/fonts/Graphik XCond-Black.otf"}]},{fontGroup:s,fontFamily:"Cross-stitch",defaultStyle:0,format:"truetype",fontOverrides:{letterSpacing:0,lineHeight:1,textTransform:!1},styles:[{name:"Black",fontStyle:"normal",fontWeight:"normal",fontUrl:"https://assets.pinterest.com/fonts/Produkt-Medium.otf"}]},{fontGroup:s,fontFamily:"Lagoon",defaultStyle:0,format:"truetype",fontOverrides:{letterSpacing:0,lineHeight:.9,textTransform:!1},styles:[{name:"Black",fontStyle:"",fontWeight:"normal",fontUrl:"https://assets.pinterest.com/fonts/Gabriello-Black.otf"}]},{fontGroup:s,fontFamily:"Lava lamp",defaultStyle:0,format:"truetype",fontOverrides:{letterSpacing:0,lineHeight:.9,textTransform:!1},styles:[{name:"Black",fontStyle:"",fontWeight:"normal",fontUrl:"https://assets.pinterest.com/fonts/Publico Banner-Ultra Italic.otf"}]},{fontGroup:s,fontFamily:"Marathon",defaultStyle:0,format:"truetype",fontOverrides:{letterSpacing:0,lineHeight:1,textTransform:!1},styles:[{name:"Black",fontStyle:"",fontWeight:"normal",fontUrl:"https://assets.pinterest.com/fonts/Produkt-Super Italic.otf"}]},{fontGroup:s,fontFamily:"Sourdough",defaultStyle:0,format:"truetype",fontOverrides:{letterSpacing:0,lineHeight:.9,textTransform:!1},styles:[{name:"Black",fontStyle:"",fontWeight:"normal",fontUrl:"https://assets.pinterest.com/fonts/Publico Banner-Bold.otf"}]},{fontGroup:s,fontFamily:"Superglue",format:"truetype",fontOverrides:{letterSpacing:0,lineHeight:.9,textTransform:!1},defaultStyle:0,styles:[{name:"Bold Italic",fontStyle:"",fontWeight:"normal",fontUrl:"https://assets.pinterest.com/fonts/Graphik-Bold+Italic.otf"}]},{fontGroup:c,fontFamily:"Merriweather",fontFaceUrl:"https://fonts.googleapis.com/css?family=Merriweather:700",fontOverrides:{letterSpacing:0,lineHeight:1.2,textTransform:!1},defaultStyle:0,styles:[{name:"Bold Italic",fontStyle:"italic",fontWeight:"700"}]},{fontGroup:s,fontFamily:"Noto Serif SC",fontFaceUrl:"https://fonts.googleapis.com/css?family=Noto+Serif+SC:400&display=swap&subset=chinese-simplified",fontOverrides:{letterSpacing:0,lineHeight:1,textTransform:!1},defaultStyle:0,styles:[{name:"Regular",fontStyle:"",fontWeight:"400"}],localeFilter:"zh-CN"},{fontGroup:s,fontFamily:"Noto Sans SC",fontFaceUrl:"https://fonts.googleapis.com/css?family=Noto+Sans+SC:400&display=swap&subset=chinese-simplified",fontOverrides:{letterSpacing:0,lineHeight:1,textTransform:!1},defaultStyle:0,styles:[{name:"Regular",fontStyle:"",fontWeight:"400"}],localeFilter:"zh-CN"},{fontGroup:s,fontFamily:"Noto Serif TC",fontFaceUrl:"https://fonts.googleapis.com/css?family=Noto+Serif+TC:400&display=swap&subset=chinese-traditional",fontOverrides:{letterSpacing:0,lineHeight:1,textTransform:!1},defaultStyle:0,styles:[{name:"Regular",fontStyle:"",fontWeight:"400"}],localeFilter:"zh-TW"},{fontGroup:s,fontFamily:"Noto Sans TC",fontFaceUrl:"https://fonts.googleapis.com/css?family=Noto+Sans+TC:400&display=swap&subset=chinese-traditional",fontOverrides:{letterSpacing:0,lineHeight:1,textTransform:!1},defaultStyle:0,styles:[{name:"Regular",fontStyle:"",fontWeight:"400"}],localeFilter:"zh-TW"},{fontGroup:s,fontFamily:"Noto Serif KR",fontFaceUrl:"https://fonts.googleapis.com/css?family=Noto+Serif+KR:400&display=swap&subset=korean",fontOverrides:{letterSpacing:0,lineHeight:1,textTransform:!1},defaultStyle:0,styles:[{name:"Regular",fontStyle:"",fontWeight:"400"}],localeFilter:"ko-KR"},{fontGroup:s,fontFamily:"Noto Sans KR",fontFaceUrl:"https://fonts.googleapis.com/css?family=Noto+Sans+KR:400&display=swap&subset=korean",fontOverrides:{letterSpacing:0,lineHeight:1,textTransform:!1},defaultStyle:0,styles:[{name:"Regular",fontStyle:"",fontWeight:"400"}],localeFilter:"ko-KR"},{fontGroup:s,fontFamily:"Noto Serif JP",fontFaceUrl:"https://fonts.googleapis.com/css?family=Noto+Serif+JP:400&display=swap&subset=japanese",fontOverrides:{letterSpacing:0,lineHeight:1,textTransform:!1},defaultStyle:0,styles:[{name:"Regular",fontStyle:"",fontWeight:"400"}],localeFilter:"ja"},{fontGroup:s,fontFamily:"Noto Sans JP",fontFaceUrl:"https://fonts.googleapis.com/css?family=Noto+Sans+JP:400&display=swap&subset=japanese",fontOverrides:{letterSpacing:0,lineHeight:1,textTransform:!1},defaultStyle:0,styles:[{name:"Regular",fontStyle:"",fontWeight:"400"}],localeFilter:"ja"},{fontGroup:s,fontFamily:"Noto Serif",fontFaceUrl:"https://fonts.googleapis.com/css?family=Noto+Serif:400&display=swap",fontOverrides:{letterSpacing:0,lineHeight:1,textTransform:!1},defaultStyle:0,styles:[{name:"Regular",fontStyle:"",fontWeight:"400"}],localeFilter:"hi-IN"},{fontGroup:s,fontFamily:"Noto Sans",fontFaceUrl:"https://fonts.googleapis.com/css?family=Noto+Sans:400&display=swap",fontOverrides:{letterSpacing:0,lineHeight:1,textTransform:!1},defaultStyle:0,styles:[{name:"Regular",fontStyle:"",fontWeight:"400"}],localeFilter:"hi-IN"},{fontGroup:c,fontFamily:"Playfair Display",fontFaceUrl:"https://fonts.googleapis.com/css?family=Playfair+Display:400",fontOverrides:{letterSpacing:0,lineHeight:1.2,textTransform:!1},defaultStyle:0,styles:[{name:"Regular",fontStyle:"",fontWeight:"400"}]},{fontGroup:c,fontFamily:"Raleway",fontFaceUrl:"https://fonts.googleapis.com/css?family=Raleway:900",fontOverrides:{letterSpacing:0,lineHeight:1.2,textTransform:!1},defaultStyle:0,styles:[{name:"Black",fontStyle:"",fontWeight:"900"}]},{fontGroup:c,fontFamily:"Roboto Condensed",fontFaceUrl:"https://fonts.googleapis.com/css?family=Roboto+Condensed:700i",fontOverrides:{letterSpacing:0,lineHeight:1.2,textTransform:!1},defaultStyle:0,styles:[{name:"Bold Italic",fontStyle:"italic",fontWeight:"700"}]},{fontGroup:c,fontFamily:"Suez One",fontFaceUrl:"https://fonts.googleapis.com/css?family=Suez+One&display=swap",fontOverrides:{letterSpacing:0,lineHeight:.9,textTransform:!1},defaultStyle:0,styles:[{name:"Regular",fontStyle:"",fontWeight:"400"}]},{fontGroup:c,fontFamily:"Domine",fontFaceUrl:"https://fonts.googleapis.com/css?family=Domine&display=swap",fontOverrides:{letterSpacing:0,lineHeight:1,textTransform:!1},defaultStyle:0,styles:[{name:"Regular",fontStyle:"",fontWeight:"400"}]},{fontGroup:c,fontFamily:"Overlock",fontFaceUrl:"https://fonts.googleapis.com/css?family=Overlock:900i&display=swap",fontOverrides:{letterSpacing:-1,lineHeight:1,textTransform:!1},defaultStyle:0,styles:[{name:"Black Italic",fontStyle:"",fontWeight:"400"}]},{fontGroup:c,fontFamily:"Satisfy",fontFaceUrl:"https://fonts.googleapis.com/css?family=Satisfy&display=swap",fontOverrides:{letterSpacing:0,lineHeight:1,textTransform:!1},defaultStyle:0,styles:[{name:"Regular",fontStyle:"",fontWeight:"400"}]}];function m(){return p}function g(t,e,n){var r=t.styles.find((function(t){return t.fontStyle===e&&t.fontWeight===n}));return r?r.name:""}function h(t,e){return t.reduce((function(t,e){return[].concat(o(t),o(e.fonts))}),[]).find((function(t){return t.fontFamily===e}))||null}function y(t){return Object(r.a)(t,i)}function v(){return Object(r.a)(m(),u)}function S(){return Object(r.a)([p[f]],l)}function b(t){var e=function(t){var e=m();if(t){var n=e.findIndex((function(e){return e.localeFilter===t}));if(n>=0)return e[n]}return e[6]}(t),n=e.defaultStyle,r=e.styles[n],o=e.fontFamily,a=e.fontOverrides,i=a&&a.textTransform?1:0,u=a&&a.lineHeight||1.2,l=a&&a.letterSpacing||0;return{fontGroupName:s,fontFamilyName:o,fontStyleName:r.name,fontWeight:r.fontWeight,fontSize:50,textColor:"#FFFFFF",marginIndex:1,alignmentIndex:1,positionIndex:2,backgroundColor:"",backgroundTransparencyIndex:0,lineHeight:u,letterSpacing:l,transformIndex:i,showMoreOptions:!1}}},gIz7:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("A0Lk"),o=n.n(r);function a(t,e){if("undefined"==typeof window)return Promise.resolve();var n=document.querySelector("#".concat(e));if(n)return Promise.resolve();(n=document.createElement("style")).setAttribute("id",e),t.filter((function(t){return!!t.fontFaceUrl})).forEach((function(t){n&&t.fontFaceUrl&&n.appendChild(document.createTextNode("@import url('".concat(t.fontFaceUrl,"');")))}));var r=document.head;if(!r)return Promise.resolve();var a=document.createElement("style");a.setAttribute("id","".concat(e,"-font-faces")),r.appendChild(n),r.appendChild(a);var i=[];return t.forEach((function(t){t.styles.forEach((function(e){t.format&&e.fontUrl&&a&&a.sheet&&a.sheet.insertRule('\n            @font-face {\n              font-family: "'.concat(t.fontFamily,'";\n              font-style: "').concat(e.fontStyle,'";\n              font-weight: "').concat(e.fontWeight,'";\n              src: url("').concat(e.fontUrl,'") format("').concat(t.format,'");\n            }'),0);i.push(new o.a(t.fontFamily,{weight:e.fontWeight,style:e.fontStyle}).load())}))})),Promise.all(i)}},wId3:function(t,e,n){"use strict";n.d(e,"a",(function(){return E}));var r=n("eOdZ");function o(t,e,n,r,o,a,i){try{var u=t[a](i),l=u.value}catch(s){return void n(s)}u.done?e(l):Promise.resolve(l).then(r,o)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var i=t.apply(e,n);function u(t){o(i,r,a,u,l,"next",t)}function l(t){o(i,r,a,u,l,"throw",t)}u(void 0)}))}}var i=[200,201,204],u=1e3;function l(){return(l=a(regeneratorRuntime.mark((function t(e){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.a.create("VIPResource",{upload_ids:e}).callGet();case 3:return n=t.sent,o=n.resource_response.data,t.abrupt("return",e.reduce((function(t,e){return t[e]={failureCode:o[e].failure_code,signature:o[e].signature,status:o[e].status},t}),{}));case 8:throw t.prev=8,t.t0=t.catch(0),t.t0;case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))).apply(this,arguments)}function s(t,e,n,r){return c.apply(this,arguments)}function c(){return(c=a(regeneratorRuntime.mark((function t(e,n,o,a){var l,s,c,d,f,p,m,g,h,y,v,S;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=a.onFailure,s=a.onFinishUpload,c=a.onStartUpload,d=a.onUploadProgress,t.prev=1,t.next=4,r.a.create("VIPResource",{type:o}).callCreate();case 4:return f=t.sent,p=f.resource_response.data,m=p.upload_id,g=p.upload_parameters,h=p.upload_url,c&&c(m),y=new Date,(v=new XMLHttpRequest).open("POST",h,!0),v.onload=function(){if(i.includes(v.status)){if(s){var t=(new Date-y)/u,e=v.getResponseHeader("x-amz-request-id"),r=v.getResponseHeader("x-amz-id-2");s(m,{amzId2:r,amzRequestId:e,uploadTimeSec:t,statusCode:v.status})}}else{var o="image"===n?1:8;l(m,"Failed to upload the media with XHR status code: ".concat(v.status),o,!0)}},v.onerror=function(){l(m,"Failed to upload the media","image"===n?1:8,!0)},d&&(v.upload.onprogress=function(t){d(Math.round(t.loaded/t.total*100))}),S=new FormData,Object.keys(g).forEach((function(t){S.append(t,g[t])})),S.append("file",e),v.send(S),t.abrupt("return",{uploadId:m,xhr:v});case 20:throw t.prev=20,t.t0=t.catch(1),t.t0;case 23:case"end":return t.stop()}}),t,null,[[1,20]])})))).apply(this,arguments)}var d=n("ZQVr");function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function g(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=v(t);if(e){var o=v(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return h(this,n)}}function h(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?y(t):e}function y(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function S(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var I=["webImage","webVideo"],O=function t(e){var n=this;S(this,t),b(this,"upload",(function(){})),b(this,"onFailure",(function(t,e,r,o){o&&n.numAttempts<n.maxUploadAttempts?n.upload():(n.status="failed",n.callbackHandlers.onFailure(t,e,r))})),b(this,"onFinishProcessing",(function(t,e){n.signature=e.signature,n.callbackHandlers.onFinishProcessing&&n.callbackHandlers.onFinishProcessing(t,e)})),b(this,"onFinishUpload",(function(){var t;(n.status="uploaded",n.callbackHandlers.onFinishUpload)&&(t=n.callbackHandlers).onFinishUpload.apply(t,arguments)})),b(this,"onStartProcessing",(function(t,e){n.signature=e.signature,n.callbackHandlers.onStartProcessing&&n.callbackHandlers.onStartProcessing(t,e)})),b(this,"cancel",(function(){n.xhr&&(n.xhr.abort(),n.callbackHandlers.onCancel&&n.callbackHandlers.onCancel(n.uploadId||""))})),this.media=e.media,this.vipType=e.vipType,this.maxUploadAttempts=e.maxUploadAttempts||1,this.numAttempts=0,this.callbackHandlers=e.callbackHandlers},w=function(t){p(n,t);var e=g(n);function n(t){var r;return S(this,n),b(y(r=e.call(this,t)),"getClassName",(function(){return"ImageUpload"})),b(y(r),"onProcessingFailed",(function(t){r.uploadId&&r.onFailure(r.uploadId,"Failed to process image with uploadId ".concat(r.uploadId," and failureCode ").concat(t),3)})),b(y(r),"onProcessingTimeout",(function(){r.uploadId&&r.onFailure(r.uploadId,"Timed out on processing video with uploadId ".concat(r.uploadId),11)})),b(y(r),"upload",(function(){"localImage"===r.media.type&&(r.numAttempts+=1,s(Object(d.a)(r.media.src),"image",r.vipType,{onFailure:r.onFailure,onFinishUpload:r.onFinishUpload,onStartUpload:r.callbackHandlers.onStartUpload,onUploadProgress:r.callbackHandlers.onUploadProgress}).then((function(t){r.uploadId=t.uploadId,r.xhr=t.xhr,r.status="uploading"})).catch((function(t){r.status="failed",r.onFailure(null,"Failed to register upload with message: ".concat(t),13)})))})),r.signature=I.includes(t.media.type)?t.media.signature:null,r.status=I.includes(t.media.type)?"uploaded":"pending",r}return n}(O),T=function(t){p(n,t);var e=g(n);function n(t){var r;return S(this,n),b(y(r=e.call(this,t)),"getClassName",(function(){return"VideoUpload"})),b(y(r),"onProcessingFailed",(function(t){r.uploadId&&r.onFailure(r.uploadId,"Failed to process video with uploadId ".concat(r.uploadId," and failureCode ").concat(t),10)})),b(y(r),"onProcessingTimeout",(function(){r.uploadId&&r.onFailure(r.uploadId,"Timed out on processing video with uploadId ".concat(r.uploadId),11)})),b(y(r),"upload",(function(){"localVideo"===r.media.type&&(r.numAttempts+=1,s(r.media.fileSrc,"video",r.vipType,{onFailure:r.onFailure,onFinishUpload:r.onFinishUpload,onStartUpload:r.callbackHandlers.onStartUpload,onUploadProgress:r.callbackHandlers.onUploadProgress}).then((function(t){r.uploadId=t.uploadId,r.xhr=t.xhr,r.status="uploading"})).catch((function(t){r.status="failed",r.onFailure(null,"Failed to register upload with message: ".concat(t),7)})))})),r.signature=I.includes(t.media.type)?t.media.signature:null,r.status=I.includes(t.media.type)?"uploaded":"pending",r}return n}(O);function F(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?F(Object(n),!0).forEach((function(e){U(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function U(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var E=function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),U(this,"checkAllUploadsProcessingOrCompleted",(function(){for(var t=0,e=0,r=Object.keys(n.mediaUploadsMap);e<r.length;e++){var o=r[e],a=n.mediaUploadsMap[o];n.inDebugMode&&console.log("[MEDIA UPLOAD MANAGER] - Status of media upload ID",o,a.mediaUpload.getClassName(),a.status),("completed"===a.status||"processing"===a.status&&"VideoUpload"===a.mediaUpload.getClassName())&&(t+=1)}return n.inDebugMode&&(console.log("[MEDIA UPLOAD MANAGER] - Checking if all upload processes completed"),console.log("Number of completed uploads:",t)),t===Object.keys(n.mediaUploadsMap).length})),U(this,"checkUploadsFailed",(function(){return!!Object.keys(n.mediaUploadsMap).find((function(t){return"failed"===n.mediaUploadsMap[t].status}))})),U(this,"updateUploadStatus",(function(t,e){return n.mediaUploadsMap[t].status=e})),U(this,"updateVIPStatusMap",(function(t){for(var e=new Date,r=0,o=Object.keys(t);r<o.length;r++){var a=o[r],i=t[a],u=i.failureCode,l=i.signature,s=i.status;if(a in n.vipStatusMap){var c=n.vipStatusMap[a].mediaId,d=n.mediaUploadsMap[c];if(u){d.mediaUpload.onProcessingFailed(u),n.updateUploadStatus(c,"failed");break}if(n.vipStatusMap[a].status!==s){if(n.vipStatusMap[a]=P(P({},n.vipStatusMap[a]),{},{status:s,timeSet:e}),"processing"===s)d.mediaUpload.onStartProcessing(a,{signature:l}),n.updateUploadStatus(c,"processing");else if("succeeded"===s){var f=(e-n.vipStatusMap[a].timeSet)/1e3;d.mediaUpload.onFinishProcessing(a,{processingTimeSec:f,signature:l}),n.updateUploadStatus(c,"completed")}}else n.statusTimeoutMap[s]&&(e-n.vipStatusMap[a].timeSet)/1e3>=n.statusTimeoutMap[s].timeoutSec&&(d.mediaUpload.onProcessingTimeout(),n.statusTimeoutMap[s].onTimeout())}}})),U(this,"handleFailure",(function(t,e){n.failed||(n.onFailure(t,e),n.failed=!0)})),U(this,"handleCheckUploadsCompleted",(function(){var t=n.checkAllUploadsProcessingOrCompleted();return t&&n.onCompleted&&!n.completed&&(n.inDebugMode&&console.log("[MEDIA UPLOAD MANAGER] - All uploads have completed & we are triggering the onCompleted callback"),n.completed=!0,n.onCompleted()),t})),U(this,"onFinishUpload",(function(t,e){n.vipStatusMap[t]={mediaId:e,status:null,timeSet:new Date},n.updateUploadStatus(e,"uploaded"),n.inDebugMode&&console.log("[MEDIA UPLOAD MANAGER] Finished uploading media ID",e),n.checkingStatus||(n.checkingStatus=!0,setTimeout((function(){return n.checkStatus()}),2e3))})),U(this,"onUploadFailed",(function(t,e,r){n.updateUploadStatus(t,"failed"),n.handleFailure(e,r),n.inDebugMode&&console.log("[MEDIA UPLOAD MANAGER] Failed uploading media ID",t)})),U(this,"removeMediaUpload",(function(t){n.mediaUploadsMap[t]&&(n.mediaUploadsMap[t].mediaUpload.cancel(),delete n.mediaUploadsMap[t])})),U(this,"addMediaUpload",(function(t,e,r,o){var a=P(P({},o),{},{onFailure:function(t,r,a){n.onUploadFailed(e,r,a),o.onFailure(t,r,a)},onFinishUpload:function(t,r){n.onFinishUpload(t,e),o.onFinishUpload&&o.onFinishUpload(t,r)}}),i="localImage"===t.type||"webImage"===t.type?new w({callbackHandlers:a,media:t,maxUploadAttempts:n.maxMediaUploadAttempts,vipType:"pinimage"}):new T({callbackHandlers:a,media:t,maxUploadAttempts:n.maxMediaUploadAttempts,vipType:"video-story-pin"});if(n.mediaUploadsMap[e]){n.mediaUploadsMap[e].mediaUpload.cancel();var u=n.mediaUploadsMap[e].mediaUpload.uploadId;u&&u in n.vipStatusMap&&delete n.vipStatusMap[u]}n.inDebugMode&&console.log("[MEDIA UPLOAD MANAGER] Added media ID to upload",e),n.mediaUploadsMap[e]={mediaUpload:i,status:"pending"},i.upload(),n.updateUploadStatus(e,"uploading")})),U(this,"reset",(function(){n.failed=!1,n.statusCheckFailureCount=0,n.completed=!1})),U(this,"cancelAll",(function(){for(var t=0,e=Object.keys(n.mediaUploadsMap);t<e.length;t++){var r=e[t];"uploading"===n.mediaUploadsMap[r].status&&n.mediaUploadsMap[r].mediaUpload.cancel()}})),U(this,"checkStatus",(function(){if(n.checkUploadsFailed())return n.checkingStatus=!1,void(n.inDebugMode&&console.log("[MEDIA UPLOAD MANAGER] There is a failure in check status",n.vipStatusMap));n.inDebugMode&&console.log("[MEDIA UPLOAD MANAGER] Checking status",n.vipStatusMap),n.checkingStatus=!0,function(t){return l.apply(this,arguments)}(Object.keys(n.vipStatusMap)).then((function(t){n.inDebugMode&&console.log("[MEDIA UPLOAD MANAGER] Check status response received",n.vipStatusMap),n.updateVIPStatusMap(t);for(var e=n.handleCheckUploadsCompleted(),r=0,o=Object.keys(n.vipStatusMap);r<o.length;r++){var a=o[r],i=n.vipStatusMap[a].mediaId;"completed"===n.mediaUploadsMap[i].status&&delete n.vipStatusMap[a]}Object.keys(n.vipStatusMap).length>0&&!e?setTimeout((function(){return n.checkStatus()}),2e3):n.checkingStatus=!1})).catch((function(t){n.statusCheckFailureCount+=1,n.statusCheckFailureCount>2?(n.inDebugMode&&console.log("[MEDIA UPLOAD MANAGER] - Failing upload because status check failed ".concat(n.statusCheckFailureCount," times")),n.handleFailure("Could not check VIP status",14),n.checkingStatus=!1):(n.inDebugMode&&console.log("[MEDIA UPLOAD MANAGER] - Continuing upload because status check only failed ".concat(n.statusCheckFailureCount," times")),setTimeout((function(){return n.checkStatus()}),2e3))}))})),this.onCancel=e.onCancel,this.onCompleted=e.onCompleted||null,this.onFailure=e.onFailure,this.statusTimeoutMap=e.statusTimeoutMap,this.maxMediaUploadAttempts=e.maxMediaUploadAttempts,this.inDebugMode=e.inDebugMode,this.checkingStatus=!1,this.completed=!1,this.failed=!1,this.statusCheckFailureCount=0,this.mediaUploadsMap={},this.vipStatusMap={}}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/js/88-39dd08dbcbeecde0391d.js.map